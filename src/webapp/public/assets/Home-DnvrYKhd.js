import{d as $,r as p,c as m,a as t,w as U,v as I,t as r,b as L,e as w,o as v,_ as C,u as V,f as N,g as P,h as T,i as y}from"./main-ChR5rvRr.js";const x={class:"modal-header"},H={class:"modal-body"},z={class:"char-count"},E={class:"modal-footer"},F=["disabled"],j=$({__name:"ThrowBottleModal",emits:["close","success"],setup(h,{emit:l}){const _=l,a=p(""),i=p(!1),n=async()=>{if(a.value.trim())try{i.value=!0,await w.post("/bottles/throw",{content:a.value.trim()}),_("success")}catch(d){console.error("æŠ•æ”¾æ¼‚æµç“¶å¤±è´¥:",d)}finally{i.value=!1}};return(d,e)=>(v(),m("div",{class:"modal-overlay",onClick:e[4]||(e[4]=b=>d.$emit("close"))},[t("div",{class:"modal-content",onClick:e[3]||(e[3]=L(()=>{},["stop"]))},[t("div",x,[e[5]||(e[5]=t("h3",null,"ðŸ“ æŠ•æ”¾æ¼‚æµç“¶",-1)),t("button",{class:"close-btn",onClick:e[0]||(e[0]=b=>d.$emit("close"))},"âœ•")]),t("div",H,[U(t("textarea",{"onUpdate:modelValue":e[1]||(e[1]=b=>a.value=b),placeholder:"å†™ä¸‹ä½ æƒ³è¯´çš„è¯...",rows:"6",maxlength:"500"},null,512),[[I,a.value]]),t("div",z,r(a.value.length)+"/500",1)]),t("div",E,[t("button",{class:"btn btn-secondary",onClick:e[2]||(e[2]=b=>d.$emit("close"))},"å–æ¶ˆ"),t("button",{class:"btn",onClick:n,disabled:!a.value.trim()||i.value},r(i.value?"æŠ•æ”¾ä¸­...":"æŠ•æ”¾"),9,F)])])]))}}),q=C(j,[["__scopeId","data-v-47d61cc7"]]),A={class:"modal-header"},G={class:"modal-body"},J={class:"bottle-content"},K={class:"bottle-info"},O={key:0,class:"reply-section"},Q={key:1,class:"reply-form"},W={class:"char-count"},X={class:"reply-actions"},Y=["disabled"],Z=$({__name:"PickedBottleModal",props:{bottle:{}},emits:["close","reply"],setup(h,{emit:l}){const _=h,a=l,i=p(!1),n=p(""),d=p(!1),e=c=>new Date(c).toLocaleString("zh-CN"),b=async()=>{if(n.value.trim())try{d.value=!0,await w.post(`/bottles/${_.bottle.id}/reply`,{content:n.value.trim()}),a("reply")}catch(c){console.error("å›žå¤å¤±è´¥:",c)}finally{d.value=!1}};return(c,o)=>(v(),m("div",{class:"modal-overlay",onClick:o[5]||(o[5]=f=>c.$emit("close"))},[t("div",{class:"modal-content",onClick:o[4]||(o[4]=L(()=>{},["stop"]))},[t("div",A,[o[6]||(o[6]=t("h3",null,"ðŸ¾ æ¡åˆ°çš„æ¼‚æµç“¶",-1)),t("button",{class:"close-btn",onClick:o[0]||(o[0]=f=>c.$emit("close"))},"âœ•")]),t("div",G,[t("div",J,[t("p",null,r(c.bottle.content),1)]),t("div",K,[t("small",null,"æ¥è‡ª: "+r(c.bottle.user_name||"åŒ¿åç”¨æˆ·"),1),t("small",null,r(e(c.bottle.created_at)),1)]),i.value?(v(),m("div",Q,[U(t("textarea",{"onUpdate:modelValue":o[2]||(o[2]=f=>n.value=f),placeholder:"å†™ä¸‹ä½ çš„å›žå¤...",rows:"4",maxlength:"300"},null,512),[[I,n.value]]),t("div",W,r(n.value.length)+"/300",1),t("div",X,[t("button",{class:"btn btn-secondary",onClick:o[3]||(o[3]=f=>i.value=!1)},"å–æ¶ˆ"),t("button",{class:"btn",onClick:b,disabled:!n.value.trim()||d.value},r(d.value?"å‘é€ä¸­...":"å‘é€"),9,Y)])])):(v(),m("div",O,[t("button",{class:"btn",onClick:o[1]||(o[1]=f=>i.value=!0)},"ðŸ’¬ å›žå¤")]))])])]))}}),tt=C(Z,[["__scopeId","data-v-5a9411f9"]]),st={class:"home-page"},et={class:"card"},ot={class:"stats-grid"},lt={class:"stat-item"},nt={class:"stat-value"},at={class:"stat-item"},it={class:"stat-value"},dt={class:"stat-item"},rt={class:"stat-value"},ct={class:"stat-item"},ut={class:"stat-value"},vt={class:"card"},pt={class:"action-buttons"},_t=["disabled"],bt=["disabled"],mt={class:"card"},ft={class:"points-info"},yt={class:"points-row"},kt={class:"points-row"},ht={class:"checkin-section"},$t=["disabled"],wt={key:0},Ct={key:1},gt={key:2},Bt=$({__name:"Home",setup(h){const l=V(),_=p(!1),a=p(!1),i=p(!1),n=p(null),d=N(()=>{var k;if(!((k=l.userPoints)!=null&&k.last_checkin))return!1;const u=new Date().toDateString(),s=new Date(l.userPoints.last_checkin).toDateString();return u===s}),e=()=>{i.value=!0},b=async()=>{try{_.value=!0;const u=await w.post("/bottles/pick");n.value=u}catch(u){console.error("æ¡æ‹¾æ¼‚æµç“¶å¤±è´¥:",u)}finally{_.value=!1}},c=async()=>{try{a.value=!0;const u=await l.checkin();console.log("ç­¾åˆ°æˆåŠŸ:",u)}catch(u){console.error("ç­¾åˆ°å¤±è´¥:",u)}finally{a.value=!1}},o=()=>{i.value=!1,l.updateUserData()},f=()=>{n.value=null,l.updateUserData()};return(u,s)=>{var k,g,B,S,D,M;return v(),m("div",st,[s[11]||(s[11]=t("div",{class:"card"},[t("h2",null,"ðŸŒŠ æ¬¢è¿Žæ¥åˆ°æ¼‚æµç“¶ä¸–ç•Œ"),t("p",null,"åœ¨è¿™é‡Œåˆ†äº«ä½ çš„å¿ƒæƒ…ï¼Œå‘çŽ°ä»–äººçš„æ•…äº‹")],-1)),t("div",et,[s[6]||(s[6]=t("h3",null,"ðŸ“Š æˆ‘çš„ç»Ÿè®¡",-1)),t("div",ot,[t("div",lt,[t("div",nt,r(((k=y(l).userStats)==null?void 0:k.bottles_thrown)||0),1),s[2]||(s[2]=t("div",{class:"stat-label"},"æŠ•æ”¾çš„ç“¶å­",-1))]),t("div",at,[t("div",it,r(((g=y(l).userStats)==null?void 0:g.bottles_picked)||0),1),s[3]||(s[3]=t("div",{class:"stat-label"},"æ¡åˆ°çš„ç“¶å­",-1))]),t("div",dt,[t("div",rt,r(((B=y(l).userStats)==null?void 0:B.bottles_replied)||0),1),s[4]||(s[4]=t("div",{class:"stat-label"},"å›žå¤çš„ç“¶å­",-1))]),t("div",ct,[t("div",ut,r(((S=y(l).userStats)==null?void 0:S.points_earned)||0),1),s[5]||(s[5]=t("div",{class:"stat-label"},"èŽ·å¾—ç§¯åˆ†",-1))])])]),t("div",vt,[s[7]||(s[7]=t("h3",null,"ðŸŽ® å¿«é€Ÿæ“ä½œ",-1)),t("div",pt,[t("button",{class:"btn",onClick:e,disabled:_.value}," ðŸ“ æŠ•æ”¾æ¼‚æµç“¶ ",8,_t),t("button",{class:"btn btn-secondary",onClick:b,disabled:_.value}," ðŸŽ£ æ¡æ‹¾æ¼‚æµç“¶ ",8,bt)])]),t("div",mt,[s[10]||(s[10]=t("h3",null,"ðŸ’° ç§¯åˆ†ä¿¡æ¯",-1)),t("div",ft,[t("div",yt,[s[8]||(s[8]=t("span",null,"æ€»ç§¯åˆ†:",-1)),t("strong",null,r(((D=y(l).userPoints)==null?void 0:D.total_points)||0),1)]),t("div",kt,[s[9]||(s[9]=t("span",null,"ç­‰çº§:",-1)),t("strong",null,r(((M=y(l).userPoints)==null?void 0:M.level)||"Lv.1"),1)]),t("div",ht,[t("button",{class:"btn",onClick:c,disabled:a.value||d.value},[a.value?(v(),m("span",wt,"ç­¾åˆ°ä¸­...")):d.value?(v(),m("span",Ct,"âœ… ä»Šæ—¥å·²ç­¾åˆ°")):(v(),m("span",gt,"ðŸ“… æ¯æ—¥ç­¾åˆ°"))],8,$t)])])]),i.value?(v(),P(q,{key:0,onClose:s[0]||(s[0]=R=>i.value=!1),onSuccess:o})):T("",!0),n.value?(v(),P(tt,{key:1,bottle:n.value,onClose:s[1]||(s[1]=R=>n.value=null),onReply:f},null,8,["bottle"])):T("",!0)])}}}),Dt=C(Bt,[["__scopeId","data-v-f7c6f957"]]);export{Dt as default};
